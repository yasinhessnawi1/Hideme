/*
==============================================
PDF HIGHLIGHTS COMPONENT STYLES
==============================================
Text highlighting and selection styling for PDF viewer
using semantic tokens from the design system
*/

/* ========================================
   TEXT SELECTION
   ======================================== */

.react-pdf__Page__textContent *::selection {
    background: rgba(var(--primary-rgb), 0.3) !important;
    color: var(--foreground) !important;
}

.react-pdf__Page__textContent.text-selection-enabled ::selection {
    background: rgba(var(--primary-rgb), 0.4) !important;
    color: var(--foreground) !important;
}

.react-pdf__Page__textContent.text-selection-enabled {
    user-select: text;
    pointer-events: auto;
    z-index: 10;
}

/* ========================================
   TEXT SELECTION HIGHLIGHT CONTAINER
   ======================================== */

.text-selection-highlight-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 8;
    mix-blend-mode: multiply;
}

.text-selection-highlight-span {
    position: absolute;
    background: rgba(var(--primary-rgb), 0.3);
    border-radius: var(--radius-sm);
    transition: background-color var(--transition-colors);
    pointer-events: auto;
    cursor: pointer;
}

/* ========================================
   TEXT SELECTION MODE
   ======================================== */

.pdf-page-wrapper.text-selection-mode::before,
.pdf-page-wrapper.text-selection-mode:hover::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(var(--primary-rgb), 0.05);
    border: 2px solid var(--primary);
    border-radius: var(--radius-card);
    pointer-events: none;
    z-index: 1;
    opacity: 0.7;
}

.pdf-page-wrapper.text-selection-mode:hover::before,
.pdf-page-wrapper.text-selection-mode.active::before {
    opacity: 1;
    background: rgba(var(--primary-rgb), 0.1);
}

/* ========================================
   ENHANCED HIGHLIGHT LAYERS WITH SOPHISTICATED EFFECTS
   ======================================== */

/* Core highlight layer positioning */
.highlight-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: visible;
    transform-origin: top left;
    z-index: 6;
}

.highlight-layer.interactive {
    pointer-events: auto;
}

/* Layer-specific z-index ordering */
.search-highlight-layer {
    z-index: 1000;
}

.entity-highlight-layer {
    z-index: 1000;
}

.manual-highlight-layer {
    z-index: 1000;
}

/* PDF page content container */
.pdf-page-content {
    position: relative;
    display: inline-block;
}

/* Highlight layers container */
.highlight-layers-container {
    position: absolute;
    pointer-events: none;
    overflow: visible;
}

/* Factory container styling */
.highlight-layer-factory {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: visible;
    isolation: isolate;
    z-index: 1000;
}

/* ========================================
   SOPHISTICATED HIGHLIGHT TYPES WITH ANIMATIONS
   ======================================== */

/* Style for highlight rectangles */
.highlight-rect,
.highlight {
    position: absolute;
    pointer-events: auto;
    transition: all var(--transition-speed, 0.2s) var(--transition-function, ease);
    transform-origin: top left;
    box-sizing: border-box;
    backface-visibility: hidden;
    border-radius: var(--radius-sm);
    opacity: 0.4;
    box-shadow: var(--shadow-xs);
    cursor: pointer;
    border: 1px solid transparent;
}

/* Highlight interactive states with animations */
.highlight-rect:hover,
.highlight:hover {
    opacity: 0.7 !important;
    transform: scale(1.01);
    box-shadow: var(--shadow-sm);
    border: 2px dotted var(--background) !important;
}

/* Define pulse animation */
@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 var(--muted);
        transform: scale(1);
    }
    50% {
        box-shadow: 0 0 0 5px transparent;
        transform: scale(1.02);
    }
    100% {
        box-shadow: 0 0 0 0 transparent;
        transform: scale(1);
    }
}

/* Selected highlight styles with sophisticated animation */
.highlight-rect.selected,
.highlight.selected {
    position: relative;
    border: 2px dashed var(--accent, var(--primary)) !important;
    opacity: 0.7 !important;
    animation: pulse var(--transition-speed, 2s) infinite;
    z-index: 10100 !important;
    outline: 2px solid var(--primary);
    outline-offset: 1px;
}

/* Ensure selected highlights are always on top */
.search-highlight-layer .highlight-rect.selected,
.entity-highlight-layer .highlight-rect.selected,
.manual-highlight-layer .highlight-rect.selected {
    z-index: 1000 !important;
}

/* Specific highlight types with distinct colors */
.search-highlight,
.highlight--search {
    background-color: var(--muted, rgba(var(--info-rgb), 0.3));
    border: 1px solid var(--primary, var(--info));
}

.search-highlight:hover,
.highlight--search:hover {
    background: rgba(var(--info-rgb), 0.4);
}

.highlight--search.current {
    background: rgba(var(--primary-rgb), 0.4);
    border-color: var(--primary);
    box-shadow: var(--shadow-primary);
}

.entity-highlight,
.highlight--entity {
    background-color: var(--hover, rgba(var(--secondary-rgb), 0.3));
    border: 1px solid var(--accent, var(--secondary));
}

.entity-highlight:hover,
.highlight--entity:hover {
    background: rgba(var(--secondary-rgb), 0.4);
}

.manual-highlight,
.highlight--manual {
    background-color: var(--success-alpha, rgba(var(--warning-rgb), 0.3));
    border: 1px solid var(--success, var(--warning));
}

.manual-highlight:hover,
.highlight--manual:hover {
    background: rgba(var(--warning-rgb), 0.4);
    box-shadow: var(--shadow-warning);
}

/* Redaction highlights */
.highlight--redaction {
    background: var(--error);
    color: var(--error-foreground);
    border-color: var(--error-dark);
}

.highlight--redaction:hover {
    background: var(--error-hover);
}

/* Selection overlay styling */
.selection-overlay {
    position: absolute;
    pointer-events: none;
    z-index: 1000;
    box-sizing: border-box;
    border: 1px dashed var(--foreground);
    background-color: var(--hover);
    border-radius: var(--radius-sm);
    animation: selectionAppear var(--transition-speed, 0.2s) var(--transition-function, ease) forwards;
}

@keyframes selectionAppear {
    from {
        opacity: 0.2;
    }
    to {
        opacity: 0.4;
    }
}

/* ========================================
   SOPHISTICATED TOOLTIP SYSTEM
   ======================================== */

/* Tooltip styles with animations */
.highlight-tooltip {
    position: fixed;
    background-color: var(--background);
    color: var(--primary-foreground);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--radius-md);
    font-size: var(--text-xs);
    pointer-events: none;
    white-space: nowrap;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    box-shadow: var(--shadow-lg);
    opacity: 0;
    animation: tooltipFadeIn var(--transition-speed, 0.2s) var(--transition-function, ease) forwards;
    z-index: var(--z-popover);
}

@keyframes tooltipFadeIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-90%);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(-100%);
    }
}

/* ========================================
   ENHANCED HIGHLIGHT CONTEXT MENU
   ======================================== */

.highlight-context-menu {
    position: fixed;
    background: var(--background-surface);
    border: var(--border-default);
    border-radius: var(--radius-dropdown);
    box-shadow: var(--shadow-dropdown);
    padding: var(--spacing-xs);
    z-index: var(--z-popover);
    min-width: 150px;
    backdrop-filter: blur(8px);
    pointer-events: auto;
}

.highlight-context-menu-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-colors);
    font-size: var(--font-size-sm);
    color: var(--foreground);
    white-space: nowrap;
    border: none;
    background: none;
    width: 100%;
    text-align: left;
}

.highlight-context-menu-item:hover {
    background-color: var(--hover);
}

.highlight-context-menu-item:focus {
    outline: none;
    background-color: var(--hover);
}

.highlight-context-menu-item.danger {
    color: var(--error);
}

.highlight-context-menu-item.danger:hover {
    background-color: var(--error);
    color: var(--error-foreground);
}

.highlight-context-menu-separator {
    height: 1px;
    background: var(--border-subtle);
    margin: var(--spacing-xs) 0;
}

.highlight-context-menu-icon {
    width: var(--space-4);
    height: var(--space-4);
    flex-shrink: 0;
}

/* ========================================
   HIGHLIGHT TOOLBAR
   ======================================== */

.highlight-toolbar {
    position: absolute;
    background: var(--background-surface);
    border: var(--border-default);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    padding: var(--spacing-xs);
    z-index: var(--z-tooltip);
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    backdrop-filter: blur(8px);
}

.highlight-toolbar-button {
    background: none;
    border: none;
    color: var(--foreground);
    cursor: pointer;
    padding: var(--spacing-xs);
    border-radius: var(--radius-md);
    transition: all var(--transition-button);
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--space-8);
    height: var(--space-8);
}

.highlight-toolbar-button:hover {
    background-color: var(--hover);
    color: var(--primary);
}

.highlight-toolbar-button.active {
    background-color: var(--primary);
    color: var(--primary-foreground);
}

.highlight-toolbar-separator {
    width: 1px;
    height: var(--space-4);
    background: var(--border-subtle);
    margin: 0 var(--spacing-xs);
}

/* ========================================
   COLOR PICKER
   ======================================== */

.highlight-color-picker {
    display: flex;
    gap: var(--spacing-xs);
    padding: var(--spacing-sm);
    background: var(--background);
    border-radius: var(--radius-md);
    border: var(--border-default);
}

.highlight-color-option {
    width: var(--space-6);
    height: var(--space-6);
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: all var(--transition-transform);
    border: 2px solid transparent;
}

.highlight-color-option:hover {
    transform: scale(1.1);
    border-color: var(--border-strong);
}

.highlight-color-option.selected {
    transform: scale(1.1);
    border-color: var(--foreground);
    box-shadow: var(--shadow-focus);
}

/* Color options */
.highlight-color-option--yellow {
    background: var(--warning);
}

.highlight-color-option--blue {
    background: var(--info);
}

.highlight-color-option--green {
    background: var(--success);
}

.highlight-color-option--red {
    background: var(--error);
}

.highlight-color-option--purple {
    background: var(--secondary);
}

.highlight-color-option--orange {
    background: var(--primary);
}

/* ========================================
   RECTANGLE SELECTION MODE
   ======================================== */

.page-overlay.rectangle-mode {
    cursor: crosshair;
}

.rectangle-selection {
    position: absolute;
    border: 2px dashed var(--primary);
    background: rgba(var(--primary-rgb), 0.1);
    border-radius: var(--radius-sm);
    pointer-events: none;
    z-index: 9;
}

/* ========================================
   LINK ANNOTATIONS
   ======================================== */

.react-pdf__Page__annotations section {
    position: relative !important;
}

.react-pdf__Page__annotations .linkAnnotation {
    border: 1px solid rgba(var(--primary-rgb), 0.3);
    background: rgba(var(--primary-rgb), 0.1);
    border-radius: var(--radius-sm);
    transition: all var(--transition-colors);
    cursor: pointer;
}

.react-pdf__Page__annotations .linkAnnotation:hover {
    border-color: var(--primary);
    background: rgba(var(--primary-rgb), 0.2);
}

.react-pdf__Page__annotations [data-annotation-id=""] {
    display: none !important;
}

.react-pdf__Page__annotations .linkAnnotation.active {
    border-color: var(--primary);
    background: rgba(var(--primary-rgb), 0.3);
    box-shadow: var(--shadow-primary);
}

/* ========================================
   CRITICAL REACT-PDF INTEGRATION STYLES
   ======================================== */

/* Critical styles for react-pdf */
.react-pdf__Page__textContent {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    z-index: 2;
    transform: none !important;
    pointer-events: none;
}

.react-pdf__Page__annotations {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    z-index: 3;
}

/* ========================================
   RESPONSIVE DESIGN WITH MOBILE ENHANCEMENTS
   ======================================== */

@media (max-width: 768px) {
    .pdf-page-wrapper {
        padding: var(--spacing-xs);
    }

    .highlight-tooltip {
        font-size: var(--font-size-xs);
        padding: var(--spacing-xs);
        max-width: 150px;
    }

    .highlight-context-menu {
        min-width: 120px;
        padding: var(--spacing-xs);
        position: fixed;
        bottom: var(--spacing-lg);
        left: var(--spacing-md);
        right: var(--spacing-md);
        width: auto;
    }

    .highlight-context-menu-item {
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: var(--font-size-xs);
    }

    .highlight-toolbar {
        padding: var(--spacing-xs);
        gap: 2px;
    }

    .highlight-toolbar-button {
        width: var(--space-6);
        height: var(--space-6);
    }

    .highlight-color-option {
        width: var(--space-5);
        height: var(--space-5);
    }
} 